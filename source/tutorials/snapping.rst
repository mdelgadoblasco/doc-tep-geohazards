SNAPPING: Surface motioN mAPPING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. image:: assets/SNAPPING_logo.png

**SNAPPING** is a medium resolution surface deformation solution based on the integration of the **ESA SentiNel Application Platform (SNAP)** and the **Standford Method for PSI (StaMPS)** [1]_, [2]_ which enable the Persistent Scatter Interferometric processing of image time series for the quantification of Earth surface displacement.
SNAPPING is composed by two subsequent services: 1) **SNAPPING IFG** and 2) **SNAPPING PSI** which need to be executed in this specific order.
Its flexible design has been optimised to provide fast PSI time series results at medium resolution and the two-fold steps fits perfectly to applications that requires continuous update PSI solutions, but not only.

-----
**SNAPPING IFG** is an on-demand service designed to generate single master DInSAR stacks with images belonging to same orbit track. The service uses SNAP v6.0 and in the current version works at subswath level. 
It produces the amplitude stack and interferometric stack needed to run SNAPPING PSI.
In the current version the reference image (master) is selected automatically as the oldest from the input list. Future version foresees user-selection for that.

**EO sources**:

    - Sentinel-1 IW SLC

**Inputs parameters**
	* **Input references**: represents each Sentinel-1 IW SLC product 
	* **Name of output interferometric stack for discovery**: represents the name of the output created stack. It can be further used to increase the time series and also is an input of **SNAPPING PSI service** 
	* **Sentinel-1 swath**: the user needs to select the IW that intersercts with the desired Area of Interest (AoI). This input will be deprecated in future version.
	* **Extend of processing area based on geobrowser user defined polygon**: represents the AoI defined by the user that will define the coverage of the generated interferogram and amplitude products.
	* **Heights used during interferometric processing**: represents the Digital Elevation Model (DEM) to be used in the coregistration and interferogram formation process.

**Outputs**
	It is possible to access to the service output but are considered intermediate products ready for the SNAPPING PSI service. The intermediate outputs are:
	* compressed interferogram and coregistered stacks in BEAM-DIMAP format
	* SNAP graphs employed in xml format
	* metadata 

**Interferogram stacks monitoring**: allows the user to see the real status of a submitted job, as the SNAPPING IFG triggers each interferogram computation **separately**.
	* Queued
	* On-going
	* Done
	* Failed

-----
**SNAPPING PSI** is an on-demand service designed to get the outputs generated by the SNAPPING IFG service and proceed with the Persistent Scatter Interferometric processing using the user defined parameters.

**Inputs**
	Input stacks are accessible using the **Interferogram stacks** data products. These stacks will be visible on the geobrowser and are querable using geometric and keywords using the search box provided.
	
**Outputs**
===========
The output of this service is a reduced resolution (using the StaMPS merge option in Step 5) PSI results with displacement rate map and time series for each point.
Three **service outputs** are provided:
* **Time series displacement**. It consists of a CSV file containing for each point:
	* **Lat/long coordinates**: corresponding to the latitude and longitude coordinates in decimal degrees units.
	* **Mean LoS velocity**: represents the mean velocity along the Line-of-Sight (LoS) direction. The unit is in *mm/year*.
	* **Vel Standard deviation**: The unit is in [mm/yr]
	* **incident angle:** The Chord diagram representing the link between the images as tunned by the user with the Matching parameter.
	* **time series displacement:** in milimeters.
	* **header containing relevant information about the generated results such as 
* **Browser visualisation product**: consists in an unsigned 8 GeoTIFF with symmetric color stretched image at 90% of absolute maximum value. 
* **Shapefile package**: consists in a compressed shapefile containing the geographical coordinates and mean LOS velocity of each resulting point.

**RELEASE NOTES**:
* **v1.0**
	1. Processing of Copernicus Sentinel-1 mission data
	2. No restriction on the size of the data stack (number of scenes to process)
	3. Processing of single IW sub-swath   
	4. Concatenation of consecutive acquisitions of the same date
	5. Reference scene selected as the oldest acquisition date  
	6. Precise or restituted orbits 
	7. Utilization of global SRTM 3 arc-seconds heights
	8. Option to apply or not atmospheric filtering
	9. Parallelization of PSI patch processing

**RELEASE ROADMAP**:
* **v2.0**
	* merging of subswath
	* selection of additional DEMs
	* selection of reference image
	* include SNAPPING Visualizer portable as output
	
.. Note:: For updating a interferometric stack it is needed to use the same master image, same AOI parameters and same stack name.

-----

Use case: Surface displacement of the .... (AOIname, Country)
=======================================================================

The tutorial introduces the use of the **SNAPPING IFG** and SNAPPING PSI services ... 


SNAPPING IFG 
--------------------


The Geobrowser offers multiple ways to monitor the evolution of each interferometric stack separately.

For this tutorial we will use a data package which is accessible through the "Data Packages" tab on the upper left of the screen. If you type "" into the search box you should be able to find a data package named "". Alternatively you can access the  `Slumgullion_data package`_ directly by clicking on the link:
.. _`_datapackage`: https://geohazards-tep.eu/t2api/share?url=


SNAPPING PSI

.. Warning:: .

Processing parameters definition
--------------------------------

Results
-------



References
==========

.. [1] M. Foumelis et al., "Esa Snap - Stamps Integrated Processing for Sentinel-1 Persistent Scatterer Interferometry," IGARSS 2018 - 2018 IEEE International Geoscience and Remote Sensing Symposium, Valencia, Spain, 2018, pp. 1364-1367, doi: https://doi.org/10.1109/IGARSS.2018.8519545 .
.. [2] Delgado Blasco, J.M.; Foumelis, M.; Stewart, C.; Hooper, A. Measuring Urban Subsidence in the Rome Metropolitan Area (Italy) with Sentinel-1 SNAP-StaMPS Persistent Scatterer Interferometry. Remote Sens. 2019, 11, 129. https://doi.org/10.3390/rs11020129 .
.. [3] 
